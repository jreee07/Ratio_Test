<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>⚡ Ratio Test Calculator ⚡</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex justify-center items-center min-h-screen">

  <div class="bg-white shadow-xl rounded-2xl p-8 w-full max-w-2xl">
    <h1 class="text-3xl font-bold text-center mb-6 text-red-600">⚡ Ratio Test Calculator ⚡</h1>

    <!-- Select PT Ratio -->
    <label class="block mb-2 font-medium">Select PT Ratio</label>
    <select id="ptRatio" class="w-full border rounded-lg p-2 mb-4">
      <option value="11000/110">11000/110</option>
      <option value="33000/110">33000/110</option>
      <option value="240/240">240/240 LT CT</option>
    </select>

    <!-- Transformer Side -->
    <label class="block mb-2 font-medium">Transformer Current Measuring Side</label>
    <select id="side" class="w-full border rounded-lg p-2 mb-4">
      <option value="LT">LT Side</option>
      <option value="HT">HT Side</option>
    </select>

    <!-- Billing OMF -->
    <label class="block mb-2 font-medium">Billing OMF</label>
    <input type="number" id="billingOMF" class="w-full border rounded-lg p-2 mb-4" placeholder="Enter Billing OMF">

    <!-- Clamp Currents -->
    <label class="block mb-2 font-medium">Clamp Meter Currents</label>
    <div class="grid grid-cols-3 gap-2 mb-4">
      <input type="number" id="clamp1" class="border rounded-lg p-2" placeholder="Clamp 1">
      <input type="number" id="clamp2" class="border rounded-lg p-2" placeholder="Clamp 2">
      <input type="number" id="clamp3" class="border rounded-lg p-2" placeholder="Clamp 3">
    </div>

    <!-- Energy Meter Currents -->
    <label class="block mb-2 font-medium">Energy Meter Current</label>
    <div class="grid grid-cols-3 gap-2 mb-4">
      <input type="number" id="meter1" class="border rounded-lg p-2" placeholder="Meter 1">
      <input type="number" id="meter2" class="border rounded-lg p-2" placeholder="Meter 2">
      <input type="number" id="meter3" class="border rounded-lg p-2" placeholder="Meter 3">
    </div>

    <!-- Calculate Button -->
    <button onclick="calculate()" class="w-full bg-blue-600 text-white font-semibold py-3 rounded-lg hover:bg-blue-700 transition">Calculate</button>

    <!-- Results -->
    <div id="results" class="mt-6 hidden bg-gray-50 p-4 rounded-xl shadow-inner"></div>
  </div>

  <script>
    function calculate() {
      let ptRatio = document.getElementById("ptRatio").value;
      let side = document.getElementById("side").value;
      let billingOMF = parseFloat(document.getElementById("billingOMF").value);

      let clamp1 = parseFloat(document.getElementById("clamp1").value) || 0;
      let clamp2 = parseFloat(document.getElementById("clamp2").value) || 0;
      let clamp3 = parseFloat(document.getElementById("clamp3").value) || 0;
      let meter1 = parseFloat(document.getElementById("meter1").value) || 0;
      let meter2 = parseFloat(document.getElementById("meter2").value) || 0;
      let meter3 = parseFloat(document.getElementById("meter3").value) || 0;

      let avgClamp = (clamp1 + clamp2 + clamp3) / 3;
      let avgMeter = (meter1 + meter2 + meter3) / 3;

      // calculate meter current based on OMF
      let calcMeterCurrent = 0;
      if (ptRatio === "11000/110" && side === "LT") {
        calcMeterCurrent = avgClamp *100 / (26.5 * billingOMF);
      } else if (ptRatio === "11000/110" && side === "HT") {
        calcMeterCurrent = avgClamp *100 / billingOMF;
      } else if (ptRatio === "33000/110" && side === "LT") {
        calcMeterCurrent = avgClamp *300/ (79.5 * billingOMF);
      } else if (ptRatio === "33000/110" && side === "HT") {
        calcMeterCurrent = avgClamp *300/ billingOMF;
      } else if (ptRatio === "240/240") {
        calcMeterCurrent = avgClamp / billingOMF;
      }

      let difference = avgMeter - calcMeterCurrent;

      let comment = "";
      if (difference >= -0.1 && difference <= 0.1) {
        comment = "✅ আলহামদুলিল্লাহ, সব কিছু ঠিক আছে ✅";
      } else {
        comment = "⚠️ কাম সারছে, ভালো করে চেক করতে হবে ⚠️";
      }

      // show results
      document.getElementById("results").classList.remove("hidden");
      document.getElementById("results").innerHTML = `
        <p><strong>Average Clamp Current:</strong> ${avgClamp.toFixed(2)}</p>
        <p><strong>Average Energy Meter Current:</strong> ${avgMeter.toFixed(2)}</p>
        <p class="bg-blue-100 p-2 rounded"><strong>Calculated Meter Current:</strong> ${calcMeterCurrent.toFixed(2)}</p>
        <p class="bg-yellow-100 p-2 rounded"><strong>Difference:</strong> ${difference.toFixed(2)}</p>
        <p class="text-center mt-3 font-bold text-lg">${comment}</p>
      `;
    }
  </script>

</body>
</html>